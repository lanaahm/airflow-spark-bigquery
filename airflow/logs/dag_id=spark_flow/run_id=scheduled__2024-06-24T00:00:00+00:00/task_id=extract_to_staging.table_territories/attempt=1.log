[2024-06-25T13:03:17.133+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: spark_flow.extract_to_staging.table_territories scheduled__2024-06-24T00:00:00+00:00 [queued]>
[2024-06-25T13:03:17.137+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: spark_flow.extract_to_staging.table_territories scheduled__2024-06-24T00:00:00+00:00 [queued]>
[2024-06-25T13:03:17.137+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2024-06-25T13:03:17.142+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): extract_to_staging.table_territories> on 2024-06-24 00:00:00+00:00
[2024-06-25T13:03:17.151+0000] {standard_task_runner.py:57} INFO - Started process 302 to run task
[2024-06-25T13:03:17.154+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'spark_flow', 'extract_to_staging.table_territories', 'scheduled__2024-06-24T00:00:00+00:00', '--job-id', '6', '--raw', '--subdir', 'DAGS_FOLDER/spark_***.py', '--cfg-path', '/tmp/tmpjf_wyjgn']
[2024-06-25T13:03:17.158+0000] {standard_task_runner.py:85} INFO - Job 6: Subtask extract_to_staging.table_territories
[2024-06-25T13:03:17.198+0000] {task_command.py:415} INFO - Running <TaskInstance: spark_flow.extract_to_staging.table_territories scheduled__2024-06-24T00:00:00+00:00 [running]> on host e32126fe0c41
[2024-06-25T13:03:17.242+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Maulana Ahmad Maliki' AIRFLOW_CTX_DAG_ID='spark_flow' AIRFLOW_CTX_TASK_ID='extract_to_staging.table_territories' AIRFLOW_CTX_EXECUTION_DATE='2024-06-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-24T00:00:00+00:00'
[2024-06-25T13:03:17.243+0000] {logging_mixin.py:151} INFO - [Extract] Start
[2024-06-25T13:03:17.243+0000] {logging_mixin.py:151} INFO - [Extract] Unzip data from 'https://raw.githubusercontent.com/graphql-compose/graphql-compose-examples/master/examples/northwind/data/csv/territories.csv' to 'territories'
[2024-06-25T13:03:17.739+0000] {logging_mixin.py:151} INFO - Extract Data https://raw.githubusercontent.com/graphql-compose/graphql-compose-examples/master/examples/northwind/data/csv/territories.csv Success
[2024-06-25T13:03:17.748+0000] {base.py:73} INFO - Using connection ID 'postgres-conn' for task execution.
[2024-06-25T13:03:17.783+0000] {logging_mixin.py:151} INFO - Error loading data into territories: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "territories_pkey"
DETAIL:  Key ("territoryID")=(01581) already exists.

[SQL: INSERT INTO territories ("territoryID", "territoryDescription", "regionID") VALUES (%(territoryID_m0)s, %(territoryDescription_m0)s, %(regionID_m0)s), (%(territoryID_m1)s, %(territoryDescription_m1)s, %(regionID_m1)s), (%(territoryID_m2)s, %(territoryDescription_m2)s, %(regionID_m2)s), (%(territoryID_m3)s, %(territoryDescription_m3)s, %(regionID_m3)s), (%(territoryID_m4)s, %(territoryDescription_m4)s, %(regionID_m4)s), (%(territoryID_m5)s, %(territoryDescription_m5)s, %(regionID_m5)s), (%(territoryID_m6)s, %(territoryDescription_m6)s, %(regionID_m6)s), (%(territoryID_m7)s, %(territoryDescription_m7)s, %(regionID_m7)s), (%(territoryID_m8)s, %(territoryDescription_m8)s, %(regionID_m8)s), (%(territoryID_m9)s, %(territoryDescription_m9)s, %(regionID_m9)s), (%(territoryID_m10)s, %(territoryDescription_m10)s, %(regionID_m10)s), (%(territoryID_m11)s, %(territoryDescription_m11)s, %(regionID_m11)s), (%(territoryID_m12)s, %(territoryDescription_m12)s, %(regionID_m12)s), (%(territoryID_m13)s, %(territoryDescription_m13)s, %(regionID_m13)s), (%(territoryID_m14)s, %(territoryDescription_m14)s, %(regionID_m14)s), (%(territoryID_m15)s, %(territoryDescription_m15)s, %(regionID_m15)s), (%(territoryID_m16)s, %(territoryDescription_m16)s, %(regionID_m16)s), (%(territoryID_m17)s, %(territoryDescription_m17)s, %(regionID_m17)s), (%(territoryID_m18)s, %(territoryDescription_m18)s, %(regionID_m18)s), (%(territoryID_m19)s, %(territoryDescription_m19)s, %(regionID_m19)s), (%(territoryID_m20)s, %(territoryDescription_m20)s, %(regionID_m20)s), (%(territoryID_m21)s, %(territoryDescription_m21)s, %(regionID_m21)s), (%(territoryID_m22)s, %(territoryDescription_m22)s, %(regionID_m22)s), (%(territoryID_m23)s, %(territoryDescription_m23)s, %(regionID_m23)s), (%(territoryID_m24)s, %(territoryDescription_m24)s, %(regionID_m24)s), (%(territoryID_m25)s, %(territoryDescription_m25)s, %(regionID_m25)s), (%(territoryID_m26)s, %(territoryDescription_m26)s, %(regionID_m26)s), (%(territoryID_m27)s, %(territoryDescription_m27)s, %(regionID_m27)s), (%(territoryID_m28)s, %(territoryDescription_m28)s, %(regionID_m28)s), (%(territoryID_m29)s, %(territoryDescription_m29)s, %(regionID_m29)s), (%(territoryID_m30)s, %(territoryDescription_m30)s, %(regionID_m30)s), (%(territoryID_m31)s, %(territoryDescription_m31)s, %(regionID_m31)s), (%(territoryID_m32)s, %(territoryDescription_m32)s, %(regionID_m32)s), (%(territoryID_m33)s, %(territoryDescription_m33)s, %(regionID_m33)s), (%(territoryID_m34)s, %(territoryDescription_m34)s, %(regionID_m34)s), (%(territoryID_m35)s, %(territoryDescription_m35)s, %(regionID_m35)s), (%(territoryID_m36)s, %(territoryDescription_m36)s, %(regionID_m36)s), (%(territoryID_m37)s, %(territoryDescription_m37)s, %(regionID_m37)s), (%(territoryID_m38)s, %(territoryDescription_m38)s, %(regionID_m38)s), (%(territoryID_m39)s, %(territoryDescription_m39)s, %(regionID_m39)s), (%(territoryID_m40)s, %(territoryDescription_m40)s, %(regionID_m40)s), (%(territoryID_m41)s, %(territoryDescription_m41)s, %(regionID_m41)s), (%(territoryID_m42)s, %(territoryDescription_m42)s, %(regionID_m42)s), (%(territoryID_m43)s, %(territoryDescription_m43)s, %(regionID_m43)s), (%(territoryID_m44)s, %(territoryDescription_m44)s, %(regionID_m44)s), (%(territoryID_m45)s, %(territoryDescription_m45)s, %(regionID_m45)s), (%(territoryID_m46)s, %(territoryDescription_m46)s, %(regionID_m46)s), (%(territoryID_m47)s, %(territoryDescription_m47)s, %(regionID_m47)s), (%(territoryID_m48)s, %(territoryDescription_m48)s, %(regionID_m48)s), (%(territoryID_m49)s, %(territoryDescription_m49)s, %(regionID_m49)s), (%(territoryID_m50)s, %(territoryDescription_m50)s, %(regionID_m50)s), (%(territoryID_m51)s, %(territoryDescription_m51)s, %(regionID_m51)s), (%(territoryID_m52)s, %(territoryDescription_m52)s, %(regionID_m52)s)]
[parameters: {'territoryID_m0': '01581', 'territoryDescription_m0': 'Westboro', 'regionID_m0': 1, 'territoryID_m1': '01730', 'territoryDescription_m1': 'Bedford', 'regionID_m1': 1, 'territoryID_m2': '01833', 'territoryDescription_m2': 'Georgetow', 'regionID_m2': 1, 'territoryID_m3': '02116', 'territoryDescription_m3': 'Boston', 'regionID_m3': 1, 'territoryID_m4': '02139', 'territoryDescription_m4': 'Cambridge', 'regionID_m4': 1, 'territoryID_m5': '02184', 'territoryDescription_m5': 'Braintree', 'regionID_m5': 1, 'territoryID_m6': '02903', 'territoryDescription_m6': 'Providence', 'regionID_m6': 1, 'territoryID_m7': '03049', 'territoryDescription_m7': 'Hollis', 'regionID_m7': 3, 'territoryID_m8': '03801', 'territoryDescription_m8': 'Portsmouth', 'regionID_m8': 3, 'territoryID_m9': '06897', 'territoryDescription_m9': 'Wilton', 'regionID_m9': 1, 'territoryID_m10': '07960', 'territoryDescription_m10': 'Morristown', 'regionID_m10': 1, 'territoryID_m11': '08837', 'territoryDescription_m11': 'Edison', 'regionID_m11': 1, 'territoryID_m12': '10019', 'territoryDescription_m12': 'NewYork', 'regionID_m12': 1, 'territoryID_m13': '10038', 'territoryDescription_m13': 'NewYork', 'regionID_m13': 1, 'territoryID_m14': '11747', 'territoryDescription_m14': 'Mellvile', 'regionID_m14': 1, 'territoryID_m15': '14450', 'territoryDescription_m15': 'Fairport', 'regionID_m15': 1, 'territoryID_m16': '19428', 'territoryDescription_m16': 'Philadelphia', 'regionID_m16': 3, 'territoryID_m17': '19713', 'territoryDescription_m17': 'Neward', 'regionID_m17': 1, 'territoryID_m18': '20852', 'territoryDescription_m18': 'Rockville', 'regionID_m18': 1, 'territoryID_m19': '27403', 'territoryDescription_m19': 'Greensboro', 'regionID_m19': 1, 'territoryID_m20': '27511', 'territoryDescription_m20': 'Cary', 'regionID_m20': 1, 'territoryID_m21': '29202', 'territoryDescription_m21': 'Columbia', 'regionID_m21': 4, 'territoryID_m22': '30346', 'territoryDescription_m22': 'Atlanta', 'regionID_m22': 4, 'territoryID_m23': '31406', 'territoryDescription_m23': 'Savannah', 'regionID_m23': 4, 'territoryID_m24': '32859', 'territoryDescription_m24': 'Orlando', 'regionID_m24': 4, 'territoryID_m25': '33607', 'territoryDescription_m25': 'Tampa', 'regionID_m25': 4, 'territoryID_m26': '40222', 'territoryDescription_m26': 'Louisville', 'regionID_m26': 1, 'territoryID_m27': '44122', 'territoryDescription_m27': 'Beachwood', 'regionID_m27': 3, 'territoryID_m28': '45839', 'territoryDescription_m28': 'Findlay', 'regionID_m28': 3, 'territoryID_m29': '48075', 'territoryDescription_m29': 'Southfield', 'regionID_m29': 3, 'territoryID_m30': '48084', 'territoryDescription_m30': 'Troy', 'regionID_m30': 3, 'territoryID_m31': '48304', 'territoryDescription_m31': 'BloomfieldHills', 'regionID_m31': 3, 'territoryID_m32': '53404', 'territoryDescription_m32': 'Racine', 'regionID_m32': 3, 'territoryID_m33': '55113', 'territoryDescription_m33': 'Roseville', 'regionID_m33': 3, 'territoryID_m34': '55439', 'territoryDescription_m34': 'Minneapolis', 'regionID_m34': 3, 'territoryID_m35': '60179', 'territoryDescription_m35': 'HoffmanEstates', 'regionID_m35': 2, 'territoryID_m36': '60601', 'territoryDescription_m36': 'Chicago', 'regionID_m36': 2, 'territoryID_m37': '72716', 'territoryDescription_m37': 'Bentonville', 'regionID_m37': 4, 'territoryID_m38': '75234', 'territoryDescription_m38': 'Dallas', 'regionID_m38': 4, 'territoryID_m39': '78759', 'territoryDescription_m39': 'Austin', 'regionID_m39': 4, 'territoryID_m40': '80202', 'territoryDescription_m40': 'Denver', 'regionID_m40': 2, 'territoryID_m41': '80909', 'territoryDescription_m41': 'ColoradoSprings', 'regionID_m41': 2, 'territoryID_m42': '85014', 'territoryDescription_m42': 'Phoenix', 'regionID_m42': 2, 'territoryID_m43': '85251', 'territoryDescription_m43': 'Scottsdale', 'regionID_m43': 2, 'territoryID_m44': '90405', 'territoryDescription_m44': 'SantaMonica', 'regionID_m44': 2, 'territoryID_m45': '94025', 'territoryDescription_m45': 'MenloPark', 'regionID_m45': 2, 'territoryID_m46': '94105', 'territoryDescription_m46': 'SanFrancisco', 'regionID_m46': 2, 'territoryID_m47': '95008', 'territoryDescription_m47': 'Campbell', 'regionID_m47': 2, 'territoryID_m48': '95054', 'territoryDescription_m48': 'SantaClara', 'regionID_m48': 2, 'territoryID_m49': '95060', 'territoryDescription_m49': 'SantaCruz', 'regionID_m49': 2, 'territoryID_m50': '98004', 'territoryDescription_m50': 'Bellevue', 'regionID_m50': 2, 'territoryID_m51': '98052', 'territoryDescription_m51': 'Redmond', 'regionID_m51': 2, 'territoryID_m52': '98104', 'territoryDescription_m52': 'Seattle', 'regionID_m52': 2}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-06-25T13:03:17.783+0000] {logging_mixin.py:151} INFO - [Extract] End
[2024-06-25T13:03:17.783+0000] {python.py:194} INFO - Done. Returned value was: None
[2024-06-25T13:03:17.790+0000] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=spark_flow, task_id=extract_to_staging.table_territories, execution_date=20240624T000000, start_date=20240625T130317, end_date=20240625T130317
[2024-06-25T13:03:17.823+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2024-06-25T13:03:17.849+0000] {taskinstance.py:2776} INFO - 1 downstream tasks scheduled from follow-on schedule check
